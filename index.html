<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Terminal Gif Maker</title>
    <link rel="stylesheet" href="./styles.css" />

    <!-- GIF encoder (client-side) — PINNED version to avoid redirects -->
    <script src="https://cdn.jsdelivr.net/npm/gif.js.optimized@1.0.1/dist/gif.js"></script>
  </head>

  <body>
    <div class="bg">
      <header class="header">
        <h1>Terminal Gif Maker</h1>
      </header>

      <main class="wrap">
        <section class="preview">
          <div class="terminal">
            <div class="terminal__topbar">
              <span class="dot dot--red"></span>
              <span class="dot dot--yellow"></span>
              <span class="dot dot--green"></span>
            </div>
            <div class="terminal__screen" id="terminalScreen" aria-label="Terminal preview"></div>
          </div>

          <div class="actions">
            <button class="btn btn--green" id="btnSim" type="button">Simulate</button>
            <button class="btn btn--green" id="btnExport" type="button">Export</button>
            <button class="btn btn--blue" id="btnSettings" type="button">Settings</button>
          </div>

          <div class="exportRow" id="exportRow" hidden>
            <div class="exportRow__left">
              <div class="spinner" id="spinner" hidden></div>
              <div class="exportStatus" id="exportStatus">Ready</div>
            </div>
            <a class="btn btn--dark" id="downloadLink" href="#" download hidden>Download</a>
          </div>
        </section>

        <section class="editor">
          <div class="tableHead">
            <div>Path</div>
            <div>Command</div>
            <div class="center">Typing<br />Animation</div>
            <div class="center">Timeout (ms)</div>
            <div class="center">+/-</div>
          </div>

          <div id="rows" class="rows"></div>

          <div class="multiBar">
            <div class="multiBar__top">
              <label class="switchRow">
                <span class="switch">
                  <input id="multilineToggle" type="checkbox" />
                  <span class="slider"></span>
                </span>
                <span class="muted">Multiline</span>
              </label>

              <div class="muted hintRight">
                Tip: Leave <b>Path</b> blank to treat a row as output. ANSI works (ex: <code>\u001b[32m</code>).
              </div>
            </div>

            <textarea
              id="multilineEditor"
              class="multiEditor"
              placeholder="Select a row above to edit its Command here…"
              spellcheck="false"
            ></textarea>
          </div>
        </section>
      </main>

      <!-- SETTINGS MODAL -->
      <div class="modal" id="settingsModal" hidden>
        <div class="modal__card">
          <div class="modal__head">
            <div class="modal__title">Settings</div>
            <button class="iconBtn" id="closeSettings" type="button" aria-label="Close">✕</button>
          </div>

          <div class="modal__grid">
            <label class="field">
              <span>Typing speed (ms/char)</span>
              <input id="setTyping" type="number" min="1" step="1" />
            </label>

            <label class="field">
              <span>Font size (px)</span>
              <input id="setFontSize" type="number" min="10" step="1" />
            </label>

            <label class="field">
              <span>Terminal padding (px)</span>
              <input id="setPad" type="number" min="8" step="1" />
            </label>

            <label class="field">
              <span>GIF scale (1–3)</span>
              <input id="setScale" type="number" min="1" max="3" step="1" />
            </label>

            <label class="field">
              <span>GIF quality (1–30, lower = better)</span>
              <input id="setQuality" type="number" min="1" max="30" step="1" />
            </label>

            <label class="field">
              <span>Video FPS</span>
              <input id="setFps" type="number" min="10" max="60" step="1" />
            </label>

            <label class="field">
              <span>Video time scale (0.25–2.0)</span>
              <input id="setVideoScale" type="number" min="0.25" max="2" step="0.25" />
            </label>

            <label class="field">
              <span>Video bitrate (Mbps)</span>
              <input id="setBitrate" type="number" min="1" max="20" step="1" />
            </label>

            <label class="field">
              <span>Theme</span>
              <select id="setTheme">
                <option value="midnight">Midnight</option>
                <option value="charcoal">Charcoal</option>
              </select>
            </label>
          </div>

          <div class="divider"></div>

          <div class="presetBlock">
            <div class="presetTitle">Presets (Import / Export JSON)</div>

            <div class="presetBtns">
              <button class="btn btn--dark" id="btnCopyJson" type="button">Copy JSON</button>
              <button class="btn btn--dark" id="btnDownloadJson" type="button">Download JSON</button>

              <label class="fileBtn">
                <input id="fileJson" type="file" accept="application/json" />
                <span class="btn btn--dark">Upload JSON</span>
              </label>
            </div>

            <textarea id="presetTextarea" class="presetTextarea" spellcheck="false"></textarea>

            <div class="presetBtns">
              <button class="btn btn--blue" id="btnLoadJson" type="button">Load JSON into editor</button>
              <button class="btn btn--dark" id="btnResetDemo" type="button">Reset demo</button>
            </div>
          </div>

          <div class="modal__foot">
            <button class="btn btn--blue" id="btnSaveSettings" type="button">Save</button>
          </div>
        </div>
      </div>

      <!-- EXPORT MODAL -->
      <div class="modal" id="exportModal" hidden>
        <div class="modal__card exportCard">
          <div class="modal__head">
            <div class="modal__title">Export</div>
            <button class="iconBtn" id="closeExport" type="button" aria-label="Close">✕</button>
          </div>

          <div class="exportChoices">
            <button class="btn btn--green" id="btnExportGif" type="button">Export GIF</button>
            <button class="btn btn--blue" id="btnExportMp4" type="button">Export MP4</button>
          </div>

          <div class="exportNote">
            MP4 export depends on browser support. If MP4 isn’t supported, it will export WebM automatically.
          </div>

          <div class="modal__foot exportFoot">
            <div class="exportMiniStatus" id="exportMiniStatus">Ready</div>
            <a class="btn btn--dark" id="downloadLinkModal" href="#" download hidden>Download</a>
          </div>
        </div>
      </div>
    </div>

    <script src="./app.js"></script>
  </body>
</html>
